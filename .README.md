# ğŸ›— AI-Powered Elevator Entrapment Risk Predictor

### Real-Time Predictive Maintenance using LSTM & IoT Sensor Simulation

An end-to-end **Machine Learning + Dashboard System** that predicts the probability of elevator entrapment using sequential sensor behavior.
This project mimics an industrial predictive safety system used in smart elevators.

---

## ğŸŒ Live Demo

ğŸš€ **Deployed Application:**
ğŸ‘‰ [https://elevator-entrapment-prediction.onrender.com](https://elevator-entrapment-prediction.onrender.com)

The application is fully hosted on Render and performs:

* Real-time sensor simulation
* Live LSTM inference
* Risk visualization dashboard
* Automatic logging

---

## ğŸš€ Project Overview

Elevator safety is mission-critical. Instead of reacting after failure, this system:

* Continuously monitors elevator signals
* Learns patterns using **LSTM time-series deep learning**
* Estimates **risk probability in real time**
* Shows alerts through an interactive dashboard

### Risk Levels

```
0 â€“ 40   â†’ SAFE  
40 â€“ 70  â†’ CHANCE TO RISK  
70 â€“ 100 â†’ UNDER RISK
```

---

## ğŸ§  Key Features

âœ” Real-time sensor simulation
âœ” Sequence-based LSTM prediction
âœ” Probability-based risk estimation
âœ” Interactive Plotly Dash UI
âœ” Auto model download from cloud
âœ” CSV logging for future analytics
âœ” Cloud deployed on Render

---

## ğŸ§© Tech Stack

| Component   | Technology      |
| ----------- | --------------- |
| Frontend    | Plotly Dash     |
| ML Model    | TensorFlow LSTM |
| Backend     | Python          |
| Storage     | CSV Logging     |
| Model Utils | joblib, gdown   |
| Deployment  | Render          |

---

## ğŸ“‚ Project Structure

```
KONE-ENTRAPMENT-PREDICTOR/
â”‚
â”œâ”€â”€ data/
â”‚   â””â”€â”€ elevator_data.csv
â”‚
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ prediction_history.csv
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ kone_production_lstm.keras
â”‚   â”œâ”€â”€ production_config.joblib
â”‚   â””â”€â”€ production_safety_cm.png
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ dash_app.py
â”‚   â”œâ”€â”€ predictor.py
â”‚   â”œâ”€â”€ sensor_simulator.py
â”‚   â”œâ”€â”€ generate_data.py
â”‚   â””â”€â”€ train_safety_lstm.py
â”‚
â”œâ”€â”€ venv/
â”œâ”€â”€ .gitignore
â””â”€â”€ requirements.txt
```

---

## âš™ How the System Works

### 1. Sensor Simulation

Generates realistic elevator signals:

* vibration
* temperature
* usage rate
* door cycles
* speed

### 2. LSTM Prediction

* Uses last 10 time steps
* Learns temporal behavior
* Outputs risk probability

### 3. Dashboard

* Gauge meter
* Trend graph
* Raw sensor view
* Status indicator

---

## ğŸ›  Installation

```bash
git clone <your-repo-url>
cd KONE-ENTRAPMENT-PREDICTOR

python -m venv venv
source venv/bin/activate      # Windows: venv\Scripts\activate

pip install -r requirements.txt
```

---

## â–¶ Run Locally

```bash
python src/dash_app.py
```

Open:

ğŸ‘‰ [http://127.0.0.1:10000](http://127.0.0.1:10000)

---

## â˜ Deployment (Render)

**Start Command**

```
python src/dash_app.py
```

Port auto-detected:

```python
port = int(os.environ.get("PORT", 10000))
```

Live URL:
ğŸ‘‰ [https://elevator-entrapment-prediction.onrender.com](https://elevator-entrapment-prediction.onrender.com)

---

## ğŸ“Š Model Concept

* Sequence Length â†’ 10
* Input Features â†’ 8
* Custom Loss â†’ Focal Loss
* Output â†’ Probability Score

This is a **predictive advisory system**, not a deterministic fault detector.

---

## ğŸ“ˆ Future Enhancements

* Real IoT integration (MQTT)
* Multi-elevator support
* Auto maintenance ticket creation
* Explainable AI dashboard
* Mobile alerts

---

ğŸ“Š Model Metrics Explanation
1. What Are We Measuring?

The model predicts a risk probability (0â€“1) that represents the chance of elevator entrapment based on the last 10 time steps of sensor data.

Instead of simple accuracy, we focus on:

How well the model detects risky situations

How early it can identify failure patterns

How reliable the probability score is

2. Key Metrics Used
âœ… Accuracy

Measures overall correct predictions

But in safety systems, accuracy alone is not enough

Because SAFE cases are more frequent than RISK cases

ğŸ‘‰ Example:
If 90% data is SAFE, a dumb model saying â€œSAFE alwaysâ€ gets 90% accuracy â€” but is useless.

âœ… Precision â€“ â€œCan we trust RISK alerts?â€

Precision = True Risk Predictions / All Predicted Risks

High precision â†’
When system says UNDER RISK, it is mostly correct

Reduces false alarms

Important for maintenance teams

âœ… Recall â€“ â€œDid we miss any real danger?â€

Recall = Detected Risks / Actual Risks

High recall â†’
The system rarely misses real entrapment situations

Most critical metric for safety projects

âœ… F1-Score â€“ Balance Between Precision & Recall

Harmonic mean of precision and recall

Used because:

False negatives = dangerous

False positives = operational cost

F1 gives balanced evaluation.

3. Confusion Matrix Meaning

The model output is divided into 3 zones:

SAFE

CHANCE TO RISK

UNDER RISK

Confusion matrix shows:

How many SAFE predicted as RISK

How many RISK predicted as SAFE

Model reliability in each zone

4. Why LSTM Instead of Normal ML?

Traditional models see:

only current row

no time behavior

LSTM learns:

vibration increasing slowly

temperature rising pattern

repeated door retries

ğŸ‘‰ Entrapment is a sequence problem, not a single value problem.

5. Custom Loss Function

Used Focal Loss instead of normal Cross-Entropy because:

Risk cases are rare

Model must focus more on difficult samples

Reduces bias toward SAFE class

6. How to Interpret Output
0 â€“ 40   â†’ SAFE  
40 â€“ 70  â†’ CHANCE TO RISK  
70 â€“ 100 â†’ UNDER RISK


Output is probability, not a hard rule

Works as an early warning system

Helps preventive maintenance

7. Real-World Impact

Detects abnormal behavior early

Reduces passenger entrapment

Helps schedule maintenance

Prevents sudden breakdowns

ğŸ§ª Sample Result Interpretation

If model predicts:

0.82 â†’ UNDER RISK â†’ immediate inspection

0.55 â†’ CHANCE TO RISK â†’ monitor closely

0.18 â†’ SAFE â†’ normal operation

---

## ğŸ¯ Learning Outcomes

* Time-series deep learning
* Industrial AI design
* Real-time visualization
* Cloud deployment
* Safety-oriented ML
